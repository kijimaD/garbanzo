<html>
    <head>
        <title>ビューワ</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <script>
         const https = require("https");
         const querystring = require("querystring");
         const url = require("url");

         const port = 10101;
         // 1.创建代理服务
         https.createServer(onRequest).listen(port);

         function onRequest(req, res) {
             const originUrl = url.parse(req.url);
             const qs = querystring.parse(originUrl.query);
             const targetUrl = qs["target"];
             const target = url.parse(targetUrl);

             const options = {
                 hostname: target.hostname,
                 port: 80,
                 path: url.format(target),
                 method: "GET"
             };

             // 2.代发请求
             const proxy = https.request(options, _res => {
                 // 3.修改响应头
                 const fieldsToRemove = ["x-frame-options", "content-security-policy"];
                 Object.keys(_res.headers).forEach(field => {
                     if (!fieldsToRemove.includes(field.toLocaleLowerCase())) {
                         res.setHeader(field, _res.headers[field]);
                     }
                 });
                 _res.pipe(res, {
                     end: true
                 });
             });
             req.pipe(proxy, {
                 end: true
             });
         }
        </script>
    </head>
    <body>
        <!-- <iframe style="width: 400px; height: 300px;" src="http://localhost:10101/?target=https%3A%2F%2Fgithub.com%2Fjoin"/>                     -->
        <!-- <iframe id="inlineFrameExample"
             title="Inline Frame Example"
             width="300"
             height="200"
             src="https://github.com">
             </iframe>
             <iframe src="https://github.com" width="800" height="600" nwdisable nwfaketop></iframe> -->
        hello world 
        
        <iframe style="width: 400px; height: 300px; float: right;" src="http://localhost:8080"/>
    </body>
</html>
